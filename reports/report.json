{"created": 1771013653.134454, "duration": 39.81635403633118, "exitcode": 0, "root": "/Users/enriquecarbonell/repo/irisbot", "environment": {}, "summary": {"passed": 24, "total": 24, "collected": 24}, "collectors": [{"nodeid": "", "outcome": "passed", "result": [{"nodeid": ".", "type": "Dir"}]}, {"nodeid": "htmlcov", "outcome": "passed", "result": []}, {"nodeid": "reports", "outcome": "passed", "result": []}, {"nodeid": "run_tests.py", "outcome": "passed", "result": []}, {"nodeid": "tests/test_config.py", "outcome": "passed", "result": [{"nodeid": "tests/test_config.py::test_ensure_dirs_creates_paths", "type": "Function", "lineno": 7}]}, {"nodeid": "tests/test_database.py", "outcome": "passed", "result": [{"nodeid": "tests/test_database.py::test_init_insert_fetch", "type": "Coroutine", "lineno": 7}]}, {"nodeid": "tests/test_database_extra.py", "outcome": "passed", "result": [{"nodeid": "tests/test_database_extra.py::test_insert_handles_execute_exception", "type": "Coroutine", "lineno": 7}, {"nodeid": "tests/test_database_extra.py::test_fetch_unit_none", "type": "Coroutine", "lineno": 40}]}, {"nodeid": "tests/test_db_manager.py", "outcome": "passed", "result": [{"nodeid": "tests/test_db_manager.py::test_db_manager_init_and_insert", "type": "Coroutine", "lineno": 5}, {"nodeid": "tests/test_db_manager.py::test_db_manager_fetch_none", "type": "Coroutine", "lineno": 25}, {"nodeid": "tests/test_db_manager.py::test_db_manager_insert_with_metadata", "type": "Coroutine", "lineno": 37}]}, {"nodeid": "tests/test_downloader.py", "outcome": "passed", "result": [{"nodeid": "tests/test_downloader.py::test_downloader_success", "type": "Coroutine", "lineno": 9}, {"nodeid": "tests/test_downloader.py::test_downloader_retries_then_fails", "type": "Coroutine", "lineno": 27}, {"nodeid": "tests/test_downloader.py::test_downloader_fetch_with_retries_success", "type": "Coroutine", "lineno": 46}, {"nodeid": "tests/test_downloader.py::test_downloader_write_error_closes_temp", "type": "Coroutine", "lineno": 63}, {"nodeid": "tests/test_downloader.py::test_downloader_context_manager", "type": "Coroutine", "lineno": 90}]}, {"nodeid": "tests/test_edge_cases.py", "outcome": "passed", "result": [{"nodeid": "tests/test_edge_cases.py::test_scraper_multiple_urls", "type": "Coroutine", "lineno": 63}, {"nodeid": "tests/test_edge_cases.py::test_db_manager_metadata_json_error", "type": "Coroutine", "lineno": 89}, {"nodeid": "tests/test_edge_cases.py::test_downloader_http_403_error", "type": "Coroutine", "lineno": 111}, {"nodeid": "tests/test_edge_cases.py::test_db_manager_multiple_inserts", "type": "Coroutine", "lineno": 131}]}, {"nodeid": "tests/test_main_extra.py", "outcome": "passed", "result": [{"nodeid": "tests/test_main_extra.py::test_scrape_unit_page_error", "type": "Coroutine", "lineno": 22}, {"nodeid": "tests/test_main_extra.py::test_scrape_unit_page_success", "type": "Coroutine", "lineno": 32}]}, {"nodeid": "tests/test_main_run_scraper.py", "outcome": "passed", "result": [{"nodeid": "tests/test_main_run_scraper.py::test_run_scraper_calls_insert", "type": "Coroutine", "lineno": 59}]}, {"nodeid": "tests/test_utils.py", "outcome": "passed", "result": [{"nodeid": "tests/test_utils.py::test_download_file_success", "type": "Coroutine", "lineno": 7}, {"nodeid": "tests/test_utils.py::test_download_file_fail", "type": "Coroutine", "lineno": 27}]}, {"nodeid": "tests/test_utils_extra.py", "outcome": "passed", "result": [{"nodeid": "tests/test_utils_extra.py::test_download_file_retries_then_success", "type": "Coroutine", "lineno": 7}, {"nodeid": "tests/test_utils_extra.py::test_download_file_write_error", "type": "Coroutine", "lineno": 25}]}, {"nodeid": "tests/test_utils_more.py", "outcome": "passed", "result": [{"nodeid": "tests/test_utils_more.py::test_fetch_with_retries_all_fail", "type": "Coroutine", "lineno": 7}]}, {"nodeid": "tests", "outcome": "passed", "result": [{"nodeid": "tests/test_config.py", "type": "Module"}, {"nodeid": "tests/test_database.py", "type": "Module"}, {"nodeid": "tests/test_database_extra.py", "type": "Module"}, {"nodeid": "tests/test_db_manager.py", "type": "Module"}, {"nodeid": "tests/test_downloader.py", "type": "Module"}, {"nodeid": "tests/test_edge_cases.py", "type": "Module"}, {"nodeid": "tests/test_main_extra.py", "type": "Module"}, {"nodeid": "tests/test_main_run_scraper.py", "type": "Module"}, {"nodeid": "tests/test_utils.py", "type": "Module"}, {"nodeid": "tests/test_utils_extra.py", "type": "Module"}, {"nodeid": "tests/test_utils_more.py", "type": "Module"}]}, {"nodeid": ".", "outcome": "passed", "result": [{"nodeid": "htmlcov", "type": "Dir"}, {"nodeid": "reports", "type": "Dir"}, {"nodeid": "run_tests.py", "type": "Module"}, {"nodeid": "tests", "type": "Dir"}]}], "tests": [{"nodeid": "tests/test_config.py::test_ensure_dirs_creates_paths", "lineno": 7, "outcome": "passed", "keywords": ["test_ensure_dirs_creates_paths", "test_config.py", "tests", "irisbot", ""], "setup": {"duration": 0.005856207999386243, "outcome": "passed"}, "call": {"duration": 0.0021214160005911253, "outcome": "passed"}, "teardown": {"duration": 0.00025587500022083987, "outcome": "passed"}}, {"nodeid": "tests/test_database.py::test_init_insert_fetch", "lineno": 7, "outcome": "passed", "keywords": ["test_init_insert_fetch", "asyncio", "pytestmark", "test_database.py", "tests", "irisbot", ""], "setup": {"duration": 0.0019796659998974064, "outcome": "passed"}, "call": {"duration": 0.014861000001474167, "outcome": "passed"}, "teardown": {"duration": 0.0010122920011781389, "outcome": "passed"}}, {"nodeid": "tests/test_database_extra.py::test_insert_handles_execute_exception", "lineno": 7, "outcome": "passed", "keywords": ["test_insert_handles_execute_exception", "asyncio", "pytestmark", "test_database_extra.py", "tests", "irisbot", ""], "setup": {"duration": 0.0012449999994714744, "outcome": "passed"}, "call": {"duration": 0.0037443750006787013, "outcome": "passed", "log": [{"name": "database", "msg": "Error insertando unidad http://example.com/u/err: execute failed", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/Users/enriquecarbonell/repo/irisbot/database.py", "filename": "database.py", "module": "database", "exc_info": null, "exc_text": "Traceback (most recent call last):\n  File \"/Users/enriquecarbonell/repo/irisbot/database.py\", line 47, in insert_unit\n    await db.execute(\n    ...<3 lines>...\n    )\n  File \"/Users/enriquecarbonell/repo/irisbot/tests/test_database_extra.py\", line 26, in execute\n    raise Exception(\"execute failed\")\nException: execute failed", "stack_info": null, "lineno": 54, "funcName": "insert_unit", "created": 1771013613.566269, "msecs": 566.0, "relativeCreated": 498.292, "thread": 8484301888, "threadName": "MainThread", "processName": "MainProcess", "process": 26158, "taskName": "Task-4"}]}, "teardown": {"duration": 0.00044416699893190525, "outcome": "passed"}}, {"nodeid": "tests/test_database_extra.py::test_fetch_unit_none", "lineno": 40, "outcome": "passed", "keywords": ["test_fetch_unit_none", "asyncio", "pytestmark", "test_database_extra.py", "tests", "irisbot", ""], "setup": {"duration": 0.0012880419999419246, "outcome": "passed"}, "call": {"duration": 0.004091707998668426, "outcome": "passed"}, "teardown": {"duration": 0.0004465420006454224, "outcome": "passed"}}, {"nodeid": "tests/test_db_manager.py::test_db_manager_init_and_insert", "lineno": 5, "outcome": "passed", "keywords": ["test_db_manager_init_and_insert", "asyncio", "pytestmark", "test_db_manager.py", "tests", "irisbot", ""], "setup": {"duration": 0.0012349999997240957, "outcome": "passed"}, "call": {"duration": 0.005809083000713144, "outcome": "passed"}, "teardown": {"duration": 0.0003952919996663695, "outcome": "passed"}}, {"nodeid": "tests/test_db_manager.py::test_db_manager_fetch_none", "lineno": 25, "outcome": "passed", "keywords": ["test_db_manager_fetch_none", "asyncio", "pytestmark", "test_db_manager.py", "tests", "irisbot", ""], "setup": {"duration": 0.0013780000008409843, "outcome": "passed"}, "call": {"duration": 0.003047834001336014, "outcome": "passed"}, "teardown": {"duration": 0.0003934999986086041, "outcome": "passed"}}, {"nodeid": "tests/test_db_manager.py::test_db_manager_insert_with_metadata", "lineno": 37, "outcome": "passed", "keywords": ["test_db_manager_insert_with_metadata", "asyncio", "pytestmark", "test_db_manager.py", "tests", "irisbot", ""], "setup": {"duration": 0.001236167001479771, "outcome": "passed"}, "call": {"duration": 0.004981790998499491, "outcome": "passed"}, "teardown": {"duration": 0.00040675000127521344, "outcome": "passed"}}, {"nodeid": "tests/test_downloader.py::test_downloader_success", "lineno": 9, "outcome": "passed", "keywords": ["test_downloader_success", "asyncio", "pytestmark", "test_downloader.py", "tests", "irisbot", ""], "setup": {"duration": 0.0011178749991813675, "outcome": "passed"}, "call": {"duration": 0.012264333001439809, "outcome": "passed"}, "teardown": {"duration": 0.00042391600072733127, "outcome": "passed"}}, {"nodeid": "tests/test_downloader.py::test_downloader_retries_then_fails", "lineno": 27, "outcome": "passed", "keywords": ["test_downloader_retries_then_fails", "asyncio", "pytestmark", "test_downloader.py", "tests", "irisbot", ""], "setup": {"duration": 0.0012532499986264156, "outcome": "passed"}, "call": {"duration": 9.017795290999857, "outcome": "passed", "log": [{"name": "downloader", "msg": "Fetch failed (https://example.com/nope.bin), attempt 1/3 \u2014 backoff 1.5s", "args": null, "levelname": "WARNING", "levelno": 30, "pathname": "/Users/enriquecarbonell/repo/irisbot/downloader.py", "filename": "downloader.py", "module": "downloader", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 63, "funcName": "fetch_with_retries", "created": 1771013613.614465, "msecs": 614.0, "relativeCreated": 546.488, "thread": 8484301888, "threadName": "MainThread", "processName": "MainProcess", "process": 26158, "taskName": "Task-22"}, {"name": "downloader", "msg": "Fetch failed (https://example.com/nope.bin), attempt 2/3 \u2014 backoff 3.0s", "args": null, "levelname": "WARNING", "levelno": 30, "pathname": "/Users/enriquecarbonell/repo/irisbot/downloader.py", "filename": "downloader.py", "module": "downloader", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 63, "funcName": "fetch_with_retries", "created": 1771013615.1197681, "msecs": 119.0, "relativeCreated": 2051.791, "thread": 8484301888, "threadName": "MainThread", "processName": "MainProcess", "process": 26158, "taskName": "Task-22"}, {"name": "downloader", "msg": "Fetch failed (https://example.com/nope.bin), attempt 3/3 \u2014 backoff 4.5s", "args": null, "levelname": "WARNING", "levelno": 30, "pathname": "/Users/enriquecarbonell/repo/irisbot/downloader.py", "filename": "downloader.py", "module": "downloader", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 63, "funcName": "fetch_with_retries", "created": 1771013618.124532, "msecs": 124.0, "relativeCreated": 5056.555, "thread": 8484301888, "threadName": "MainThread", "processName": "MainProcess", "process": 26158, "taskName": "Task-22"}, {"name": "downloader", "msg": "Failed to fetch https://example.com/nope.bin after 3 attempts", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/Users/enriquecarbonell/repo/irisbot/downloader.py", "filename": "downloader.py", "module": "downloader", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 71, "funcName": "fetch_with_retries", "created": 1771013622.626422, "msecs": 626.0, "relativeCreated": 9558.445, "thread": 8484301888, "threadName": "MainThread", "processName": "MainProcess", "process": 26158, "taskName": "Task-22"}]}, "teardown": {"duration": 0.002044374999968568, "outcome": "passed"}}, {"nodeid": "tests/test_downloader.py::test_downloader_fetch_with_retries_success", "lineno": 46, "outcome": "passed", "keywords": ["test_downloader_fetch_with_retries_success", "asyncio", "pytestmark", "test_downloader.py", "tests", "irisbot", ""], "setup": {"duration": 0.005137333000675426, "outcome": "passed"}, "call": {"duration": 1.511821415999293, "outcome": "passed", "log": [{"name": "downloader", "msg": "Fetch failed (https://example.com/retry.bin), attempt 1/3 \u2014 backoff 1.5s", "args": null, "levelname": "WARNING", "levelno": 30, "pathname": "/Users/enriquecarbonell/repo/irisbot/downloader.py", "filename": "downloader.py", "module": "downloader", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 63, "funcName": "fetch_with_retries", "created": 1771013622.643799, "msecs": 643.0, "relativeCreated": 9575.822, "thread": 8484301888, "threadName": "MainThread", "processName": "MainProcess", "process": 26158, "taskName": "Task-25"}]}, "teardown": {"duration": 0.003941375000067637, "outcome": "passed"}}, {"nodeid": "tests/test_downloader.py::test_downloader_write_error_closes_temp", "lineno": 63, "outcome": "passed", "keywords": ["test_downloader_write_error_closes_temp", "asyncio", "pytestmark", "test_downloader.py", "tests", "irisbot", ""], "setup": {"duration": 0.004311874999984866, "outcome": "passed"}, "call": {"duration": 0.010963250000713742, "outcome": "passed", "log": [{"name": "downloader", "msg": "Error guardando archivo /private/var/folders/nt/xgh8n6tn6dj1vqw0ykb_64640000gn/T/pytest-of-enriquecarbonell/pytest-18/test_downloader_write_error_cl0/file.bin: mock write error", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/Users/enriquecarbonell/repo/irisbot/downloader.py", "filename": "downloader.py", "module": "downloader", "exc_info": null, "exc_text": "Traceback (most recent call last):\n  File \"/Users/enriquecarbonell/repo/irisbot/downloader.py\", line 82, in download\n    tmp.write_bytes(data)\n    ~~~~~~~~~~~~~~~^^^^^^\n  File \"/Users/enriquecarbonell/repo/irisbot/tests/test_downloader.py\", line 77, in fake_write\n    raise OSError(\"mock write error\")\nOSError: mock write error", "stack_info": null, "lineno": 86, "funcName": "download", "created": 1771013624.1705961, "msecs": 170.0, "relativeCreated": 11102.619, "thread": 8484301888, "threadName": "MainThread", "processName": "MainProcess", "process": 26158, "taskName": "Task-28"}]}, "teardown": {"duration": 0.0006502090000140015, "outcome": "passed"}}, {"nodeid": "tests/test_downloader.py::test_downloader_context_manager", "lineno": 90, "outcome": "passed", "keywords": ["test_downloader_context_manager", "asyncio", "pytestmark", "test_downloader.py", "tests", "irisbot", ""], "setup": {"duration": 0.0005514999993465608, "outcome": "passed"}, "call": {"duration": 0.00056912500076578, "outcome": "passed"}, "teardown": {"duration": 0.00034295799923711456, "outcome": "passed"}}, {"nodeid": "tests/test_edge_cases.py::test_scraper_multiple_urls", "lineno": 63, "outcome": "passed", "keywords": ["test_scraper_multiple_urls", "asyncio", "pytestmark", "test_edge_cases.py", "tests", "irisbot", ""], "setup": {"duration": 0.00039820799975132104, "outcome": "passed"}, "call": {"duration": 0.06228558300063014, "outcome": "passed", "log": [{"name": "asyncio", "msg": "Unclosed client session\nclient_session: <aiohttp.client.ClientSession object at 0x107b7ad50>", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", "filename": "base_events.py", "module": "base_events", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 1871, "funcName": "default_exception_handler", "created": 1771013624.180114, "msecs": 180.0, "relativeCreated": 11112.137, "thread": 8484301888, "threadName": "MainThread", "processName": "MainProcess", "process": 26158, "taskName": "Task-34"}, {"name": "asyncio", "msg": "Unclosed client session\nclient_session: <aiohttp.client.ClientSession object at 0x107b7a5d0>", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", "filename": "base_events.py", "module": "base_events", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 1871, "funcName": "default_exception_handler", "created": 1771013624.1802292, "msecs": 180.0, "relativeCreated": 11112.252, "thread": 8484301888, "threadName": "MainThread", "processName": "MainProcess", "process": 26158, "taskName": "Task-34"}, {"name": "asyncio", "msg": "Unclosed client session\nclient_session: <aiohttp.client.ClientSession object at 0x107b7ac10>", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", "filename": "base_events.py", "module": "base_events", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 1871, "funcName": "default_exception_handler", "created": 1771013624.180287, "msecs": 180.0, "relativeCreated": 11112.31, "thread": 8484301888, "threadName": "MainThread", "processName": "MainProcess", "process": 26158, "taskName": "Task-34"}]}, "teardown": {"duration": 0.000442915999883553, "outcome": "passed"}}, {"nodeid": "tests/test_edge_cases.py::test_db_manager_metadata_json_error", "lineno": 89, "outcome": "passed", "keywords": ["test_db_manager_metadata_json_error", "asyncio", "pytestmark", "test_edge_cases.py", "tests", "irisbot", ""], "setup": {"duration": 0.001501208000263432, "outcome": "passed"}, "call": {"duration": 0.007335540998610668, "outcome": "passed"}, "teardown": {"duration": 0.0004147500003455207, "outcome": "passed"}}, {"nodeid": "tests/test_edge_cases.py::test_downloader_http_403_error", "lineno": 111, "outcome": "passed", "keywords": ["test_downloader_http_403_error", "asyncio", "pytestmark", "test_edge_cases.py", "tests", "irisbot", ""], "setup": {"duration": 0.001291915999900084, "outcome": "passed"}, "call": {"duration": 9.014302083000075, "outcome": "passed", "log": [{"name": "downloader", "msg": "Fetch failed (https://example.com/forbidden.bin), attempt 1/3 \u2014 backoff 1.5s", "args": null, "levelname": "WARNING", "levelno": 30, "pathname": "/Users/enriquecarbonell/repo/irisbot/downloader.py", "filename": "downloader.py", "module": "downloader", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 63, "funcName": "fetch_with_retries", "created": 1771013624.252807, "msecs": 252.0, "relativeCreated": 11184.83, "thread": 8484301888, "threadName": "MainThread", "processName": "MainProcess", "process": 26158, "taskName": "Task-40"}, {"name": "downloader", "msg": "Fetch failed (https://example.com/forbidden.bin), attempt 2/3 \u2014 backoff 3.0s", "args": null, "levelname": "WARNING", "levelno": 30, "pathname": "/Users/enriquecarbonell/repo/irisbot/downloader.py", "filename": "downloader.py", "module": "downloader", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 63, "funcName": "fetch_with_retries", "created": 1771013625.756802, "msecs": 756.0, "relativeCreated": 12688.825, "thread": 8484301888, "threadName": "MainThread", "processName": "MainProcess", "process": 26158, "taskName": "Task-40"}, {"name": "downloader", "msg": "Fetch failed (https://example.com/forbidden.bin), attempt 3/3 \u2014 backoff 4.5s", "args": null, "levelname": "WARNING", "levelno": 30, "pathname": "/Users/enriquecarbonell/repo/irisbot/downloader.py", "filename": "downloader.py", "module": "downloader", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 63, "funcName": "fetch_with_retries", "created": 1771013628.7608519, "msecs": 760.0, "relativeCreated": 15692.875, "thread": 8484301888, "threadName": "MainThread", "processName": "MainProcess", "process": 26158, "taskName": "Task-40"}, {"name": "downloader", "msg": "Failed to fetch https://example.com/forbidden.bin after 3 attempts", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/Users/enriquecarbonell/repo/irisbot/downloader.py", "filename": "downloader.py", "module": "downloader", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 71, "funcName": "fetch_with_retries", "created": 1771013633.2624168, "msecs": 262.0, "relativeCreated": 20194.44, "thread": 8484301888, "threadName": "MainThread", "processName": "MainProcess", "process": 26158, "taskName": "Task-40"}]}, "teardown": {"duration": 0.0006687080003757728, "outcome": "passed"}}, {"nodeid": "tests/test_edge_cases.py::test_db_manager_multiple_inserts", "lineno": 131, "outcome": "passed", "keywords": ["test_db_manager_multiple_inserts", "asyncio", "pytestmark", "test_edge_cases.py", "tests", "irisbot", ""], "setup": {"duration": 0.0026171250010520453, "outcome": "passed"}, "call": {"duration": 0.009173916001600446, "outcome": "passed"}, "teardown": {"duration": 0.00039679200017417315, "outcome": "passed"}}, {"nodeid": "tests/test_main_extra.py::test_scrape_unit_page_error", "lineno": 22, "outcome": "passed", "keywords": ["test_scrape_unit_page_error", "asyncio", "pytestmark", "test_main_extra.py", "tests", "irisbot", ""], "setup": {"duration": 0.0003950829996028915, "outcome": "passed"}, "call": {"duration": 0.0019834999984595925, "outcome": "passed", "log": [{"name": "scraper", "msg": "Error al scrapear http://example.com/x: navigation failed", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/Users/enriquecarbonell/repo/irisbot/scraper.py", "filename": "scraper.py", "module": "scraper", "exc_info": null, "exc_text": "Traceback (most recent call last):\n  File \"/Users/enriquecarbonell/repo/irisbot/scraper.py\", line 37, in scrape_unit_page\n    await page.goto(unit_url, timeout=PLAYWRIGHT_TIMEOUT_MS)\n  File \"/Users/enriquecarbonell/repo/irisbot/tests/test_main_extra.py\", line 12, in goto\n    raise RuntimeError(\"navigation failed\")\nRuntimeError: navigation failed", "stack_info": null, "lineno": 42, "funcName": "scrape_unit_page", "created": 1771013633.278561, "msecs": 278.0, "relativeCreated": 20210.584, "thread": 8484301888, "threadName": "MainThread", "processName": "MainProcess", "process": 26158, "taskName": "Task-46"}]}, "teardown": {"duration": 0.00040504200114810374, "outcome": "passed"}}, {"nodeid": "tests/test_main_extra.py::test_scrape_unit_page_success", "lineno": 32, "outcome": "passed", "keywords": ["test_scrape_unit_page_success", "asyncio", "pytestmark", "test_main_extra.py", "tests", "irisbot", ""], "setup": {"duration": 0.0004322499989939388, "outcome": "passed"}, "call": {"duration": 0.0003425839986448409, "outcome": "passed"}, "teardown": {"duration": 0.00036829199962085113, "outcome": "passed"}}, {"nodeid": "tests/test_main_run_scraper.py::test_run_scraper_calls_insert", "lineno": 59, "outcome": "passed", "keywords": ["test_run_scraper_calls_insert", "asyncio", "pytestmark", "test_main_run_scraper.py", "tests", "irisbot", ""], "setup": {"duration": 0.0004204159995424561, "outcome": "passed"}, "call": {"duration": 0.00037849999898753595, "outcome": "passed"}, "teardown": {"duration": 0.0003173750010319054, "outcome": "passed"}}, {"nodeid": "tests/test_utils.py::test_download_file_success", "lineno": 7, "outcome": "passed", "keywords": ["test_download_file_success", "asyncio", "pytestmark", "test_utils.py", "tests", "irisbot", ""], "setup": {"duration": 0.0014055000010557706, "outcome": "passed"}, "call": {"duration": 0.006187375000081374, "outcome": "passed"}, "teardown": {"duration": 0.00034308300018892623, "outcome": "passed"}}, {"nodeid": "tests/test_utils.py::test_download_file_fail", "lineno": 27, "outcome": "passed", "keywords": ["test_download_file_fail", "asyncio", "pytestmark", "test_utils.py", "tests", "irisbot", ""], "setup": {"duration": 0.0011461659996712115, "outcome": "passed"}, "call": {"duration": 9.010390583000117, "outcome": "passed", "log": [{"name": "utils", "msg": "Fetch failed (https://example.com/missing.jpg), attempt 1/3 \u2014 backoff 1.5s", "args": null, "levelname": "WARNING", "levelno": 30, "pathname": "/Users/enriquecarbonell/repo/irisbot/utils.py", "filename": "utils.py", "module": "utils", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 28, "funcName": "_fetch_with_retries", "created": 1771013633.296447, "msecs": 296.0, "relativeCreated": 20228.47, "thread": 8484301888, "threadName": "MainThread", "processName": "MainProcess", "process": 26158, "taskName": "Task-58"}, {"name": "utils", "msg": "Fetch failed (https://example.com/missing.jpg), attempt 2/3 \u2014 backoff 3.0s", "args": null, "levelname": "WARNING", "levelno": 30, "pathname": "/Users/enriquecarbonell/repo/irisbot/utils.py", "filename": "utils.py", "module": "utils", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 28, "funcName": "_fetch_with_retries", "created": 1771013634.7985559, "msecs": 798.0, "relativeCreated": 21730.579, "thread": 8484301888, "threadName": "MainThread", "processName": "MainProcess", "process": 26158, "taskName": "Task-58"}, {"name": "utils", "msg": "Fetch failed (https://example.com/missing.jpg), attempt 3/3 \u2014 backoff 4.5s", "args": null, "levelname": "WARNING", "levelno": 30, "pathname": "/Users/enriquecarbonell/repo/irisbot/utils.py", "filename": "utils.py", "module": "utils", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 28, "funcName": "_fetch_with_retries", "created": 1771013637.8010361, "msecs": 801.0, "relativeCreated": 24733.059, "thread": 8484301888, "threadName": "MainThread", "processName": "MainProcess", "process": 26158, "taskName": "Task-58"}, {"name": "utils", "msg": "Failed to fetch https://example.com/missing.jpg after 3 attempts", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/Users/enriquecarbonell/repo/irisbot/utils.py", "filename": "utils.py", "module": "utils", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 30, "funcName": "_fetch_with_retries", "created": 1771013642.302098, "msecs": 302.0, "relativeCreated": 29234.121, "thread": 8484301888, "threadName": "MainThread", "processName": "MainProcess", "process": 26158, "taskName": "Task-58"}]}, "teardown": {"duration": 0.0014247919989429647, "outcome": "passed"}}, {"nodeid": "tests/test_utils_extra.py::test_download_file_retries_then_success", "lineno": 7, "outcome": "passed", "keywords": ["test_download_file_retries_then_success", "asyncio", "pytestmark", "test_utils_extra.py", "tests", "irisbot", ""], "setup": {"duration": 0.00378729200019734, "outcome": "passed"}, "call": {"duration": 1.5155667079998238, "outcome": "passed", "log": [{"name": "asyncio", "msg": "Unclosed client session\nclient_session: <aiohttp.client.ClientSession object at 0x107d11a90>", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", "filename": "base_events.py", "module": "base_events", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 1871, "funcName": "default_exception_handler", "created": 1771013642.3129148, "msecs": 312.0, "relativeCreated": 29244.938, "thread": 8484301888, "threadName": "MainThread", "processName": "MainProcess", "process": 26158, "taskName": "Task-61"}, {"name": "utils", "msg": "Fetch failed (https://example.com/retry.jpg), attempt 1/3 \u2014 backoff 1.5s", "args": null, "levelname": "WARNING", "levelno": 30, "pathname": "/Users/enriquecarbonell/repo/irisbot/utils.py", "filename": "utils.py", "module": "utils", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 28, "funcName": "_fetch_with_retries", "created": 1771013642.3173912, "msecs": 317.0, "relativeCreated": 29249.414, "thread": 8484301888, "threadName": "MainThread", "processName": "MainProcess", "process": 26158, "taskName": "Task-61"}]}, "teardown": {"duration": 0.0013021659997320967, "outcome": "passed"}}, {"nodeid": "tests/test_utils_extra.py::test_download_file_write_error", "lineno": 25, "outcome": "passed", "keywords": ["test_download_file_write_error", "asyncio", "pytestmark", "test_utils_extra.py", "tests", "irisbot", ""], "setup": {"duration": 0.004342959000496194, "outcome": "passed"}, "call": {"duration": 0.007902875000581844, "outcome": "passed", "log": [{"name": "utils", "msg": "Error guardando archivo /private/var/folders/nt/xgh8n6tn6dj1vqw0ykb_64640000gn/T/pytest-of-enriquecarbonell/pytest-18/test_download_file_write_error0/writeerr.jpg: disk error", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/Users/enriquecarbonell/repo/irisbot/utils.py", "filename": "utils.py", "module": "utils", "exc_info": null, "exc_text": "Traceback (most recent call last):\n  File \"/Users/enriquecarbonell/repo/irisbot/utils.py\", line 48, in download_file\n    tmp.write_bytes(data)\n    ~~~~~~~~~~~~~~~^^^^^^\n  File \"/Users/enriquecarbonell/repo/irisbot/tests/test_utils_extra.py\", line 37, in fake_write\n    raise OSError(\"disk error\")\nOSError: disk error", "stack_info": null, "lineno": 52, "funcName": "download_file", "created": 1771013643.839405, "msecs": 839.0, "relativeCreated": 30771.428, "thread": 8484301888, "threadName": "MainThread", "processName": "MainProcess", "process": 26158, "taskName": "Task-64"}]}, "teardown": {"duration": 0.0007897920004324988, "outcome": "passed"}}, {"nodeid": "tests/test_utils_more.py::test_fetch_with_retries_all_fail", "lineno": 7, "outcome": "passed", "keywords": ["test_fetch_with_retries_all_fail", "asyncio", "pytestmark", "test_utils_more.py", "tests", "irisbot", ""], "setup": {"duration": 0.0035492919996613637, "outcome": "passed"}, "call": {"duration": 9.018225542000437, "outcome": "passed", "log": [{"name": "utils", "msg": "Fetch failed (https://example.com/always500.jpg), attempt 1/3 \u2014 backoff 1.5s", "args": null, "levelname": "WARNING", "levelno": 30, "pathname": "/Users/enriquecarbonell/repo/irisbot/utils.py", "filename": "utils.py", "module": "utils", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 28, "funcName": "_fetch_with_retries", "created": 1771013643.851151, "msecs": 851.0, "relativeCreated": 30783.174, "thread": 8484301888, "threadName": "MainThread", "processName": "MainProcess", "process": 26158, "taskName": "Task-67"}, {"name": "utils", "msg": "Fetch failed (https://example.com/always500.jpg), attempt 2/3 \u2014 backoff 3.0s", "args": null, "levelname": "WARNING", "levelno": 30, "pathname": "/Users/enriquecarbonell/repo/irisbot/utils.py", "filename": "utils.py", "module": "utils", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 28, "funcName": "_fetch_with_retries", "created": 1771013645.355377, "msecs": 355.0, "relativeCreated": 32287.4, "thread": 8484301888, "threadName": "MainThread", "processName": "MainProcess", "process": 26158, "taskName": "Task-67"}, {"name": "utils", "msg": "Fetch failed (https://example.com/always500.jpg), attempt 3/3 \u2014 backoff 4.5s", "args": null, "levelname": "WARNING", "levelno": 30, "pathname": "/Users/enriquecarbonell/repo/irisbot/utils.py", "filename": "utils.py", "module": "utils", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 28, "funcName": "_fetch_with_retries", "created": 1771013648.36025, "msecs": 360.0, "relativeCreated": 35292.273, "thread": 8484301888, "threadName": "MainThread", "processName": "MainProcess", "process": 26158, "taskName": "Task-67"}, {"name": "utils", "msg": "Failed to fetch https://example.com/always500.jpg after 3 attempts", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/Users/enriquecarbonell/repo/irisbot/utils.py", "filename": "utils.py", "module": "utils", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 30, "funcName": "_fetch_with_retries", "created": 1771013652.862022, "msecs": 862.0, "relativeCreated": 39794.045, "thread": 8484301888, "threadName": "MainThread", "processName": "MainProcess", "process": 26158, "taskName": "Task-67"}]}, "teardown": {"duration": 0.0020607080004992895, "outcome": "passed"}}]}